
# Libraries
```{r}
library(tidyverse)
library(quantmod)
library(getopt)
library(ggplot2)

source('data_funcs.r')
```


# Data Gathering

## Data Import Options
```{r}
opts_list <- get_options()
```

## Checking Options
```{r}
opts_list 

tick <- opts_list[1]
st <- opts_list[2]
en <- opts_list[3]

check_opts(tick, st, en)
```



## Importing Data
```{r}

apple_series <- getSymbols(Symbols = tick, src='yahoo', auto.assign=FALSE, from=st, to=en)
daily_returns <- (dailyReturn(apple_series))
volatility(apple_series)
```


# Building  Data Frame

## Initializing Data
```{r}

daily_returns <- data.frame(dailyReturn(apple_series)) %>%
  rownames_to_column("Dates") %>%
  mutate(Dates = ymd(Dates))

apple_df <- as.data.frame(apple_series) %>%
  rownames_to_column("Dates") %>%
  mutate(Dates = ymd(Dates)) %>%
  left_join(daily_returns, by = join_by(Dates))

apple_df
```

## Data Views
```{r}
apple_df %>%
  ggplot() +
  geom_histogram(aes(x = daily.returns), color = 'black', fill = 'blue') +
  theme_grey() +
  ggtitle('Histogram of Daily Returns over Selected Period')

apple_df %>%
  ggplot() +
  geom_line(aes(x = Dates, y = AAPL.Close)) + 
  theme_grey() +
  ggtitle('Scatterplot of Apple Close Prices over Selected Period') 

apple_df %>%
  ggplot() +
  geom_line(aes(x = Dates, y = AAPL.Close)) +
  theme_grey()

```

# Saving Dataset
```{r}
wd <- getwd()
filename <- paste0(wd, "/stock_df.csv")

write.csv(apple_df, filename, row.names = F)
```




